.controller( 'LoginCtrl', function ( $scope, $state, $timeout) {
    console.log("Login FBcontroller");//ingresa al login.html
    var prueba;
    prueba= function(){
      FirebaseDB.Autenticar().then(function(){})
    }
    if(prueba===true){
      //var fbAut=FirebaseDB.isAuth(),
      console.log("verdadero");
      //$state.go('app.menu', {})//ingresa a la app porque existe un usuario
    }else{
      console.log("falso");
    }
      
  $scope.doLoginAction = function (_credentials) {
    //FirebaseDB.login(_credentials)
    firebase.auth().signInWithEmailAndPassword(_credentials.email, _credentials.password)
    .then(function (authData) {
      console.log("Logueado como (FBC):", authData.uid);
      $state.go('app.menu', {})//login en menu 
      currentUser = authData
      console.log("Auntenticado (login serv)");
      return authData
    })
    .catch(function (error) {
        // Handle Errors here.
        var errorCode = error.code;
        var errorMessage = error.message;
        console.error("Fallo en Authentication :", error);
        // ...
    });
  }
  $scope.login_social= function(google){
    var provider = new firebase.auth.GoogleAuthProvider();
    firebase.auth().signInWithPopup(provider)
    .then(function (result){
      //   This gives you a Google Access Token. You can use it to access the Google API.
    var token = result.credential.accessToken;
    // The signed-in user info.
    var user = result.user;
    // ...
    $state.go('app.menu', {})
    })
    .catch(function(error) {
      // Handle Errors here.
      var errorCode = error.code;
      var errorMessage = error.message;
      // The email of the user's account used.
      var email = error.email;
      // The firebase.auth.AuthCredential type that was used.
      var credential = error.credential;
      console.error("Fallo en Authentication google:", error);
       // ...
    });
  },
  $scope.loginFace= function(facebook){
    var provider = new firebase.auth.FacebookAuthProvider();
    firebase.auth().signInWithPopup(provider)
    .then(function (result){
      var token = result.credential.accessToken;
    // The signed-in user info.
    var user = result.user;
    // ...
      $state.go('app.menu', {})
    })
    .catch(function(error) {
          // Handle Errors here.
        var errorCode = error.code;
        var errorMessage = error.message;
          // The email of the user's account used.
        var email = error.email;
        // The firebase.auth.AuthCredential type that was used.
        var credential = error.credential;
        // ...
        console.error("Fallo en Authentication face :", error);
      })
  }


  $scope.doCreateUserAction = function (_credentials) {

    firebase.auth().createUserWithEmailAndPassword(_credentials.email, _credentials.password)
    .then(function (authData) {
      // add the user to a seperate list 
      var ref = instance.database().ref('Trash-Talk/users');
        return ref.child(authData.uid).set({
          "provider": authData.providerData[0],
          "avatar": (authData.profileImageURL || "missing"),
          "displayName": authData.email
        })
      console.log("Logged in as:", authData);
      $state.go('app.menu', {})
    })
           //})
    .catch(function (error) {
      // Handle Errors here.
      var errorCode = error.code;
      var errorMessage = error.message;
      console.error("Authentication failed:", error);
      // ...
    });
  }


$scope.doLogout = function () {
      $timeout(function () {
        $state.go('login', {})
      }, 1);

      firebase.auth().signOut()
      console.log("Saliendo ...");

    }